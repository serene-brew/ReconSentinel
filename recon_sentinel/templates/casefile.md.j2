# ReconSentinel Casefile — {{ org }}

**Run time:** {{ run_time }}  
**Scope domains:** {% for d in scope_domains %}`{{ d }}`{% if not loop.last %}, {% endif %}{% endfor %}

> **Safety**: This report includes passive reconnaissance data. {% if portscan_data and portscan_data|length > 0 %}**Active port scanning was performed on scope domains.**{% else %}No active port scanning was performed.{% endif %}

---

## Summary
- **Total subdomains (in-scope):** {{ stats.total_subdomains }}
- **New since last run:** {{ stats.new_subdomains }}
- **DNS issues detected:** {{ stats.dns_issues | length }}
{% if portscan_data and portscan_data|length > 0 %}
- **Domains port scanned:** {{ portscan_data|length }}
{% endif %}

---

## Findings (Why it matters → Next steps)

{% for f in findings %}
### {{ f.title }}
**Asset:** `{{ f.asset }}`  
**Why it matters:** {{ f.why }}  
**Evidence:** {{ f.evidence }}
{% if f.next_steps %}
**Next steps:**  
{% for step in f.next_steps %}- {{ step }}
{% endfor %}
{% endif %}

---
{% endfor %}

## Inventory — In-scope Subdomains
{% for item in inventory %}
- `{{ item.host }}` — {{ item.records_summary }}
{% endfor %}

---

## Port Scan Results
{% if portscan_data and portscan_data|length > 0 %}
{% for scan in portscan_data %}
### {{ scan.domain }}

**Artifact:** `{{ scan.artifact_path }}`

#### Summary
{% if scan.data.summary %}
{% for line in scan.data.summary %}
- {{ line }}
{% endfor %}
{% else %}
_(No summary available)_
{% endif %}

#### Open Ports
{% if scan.data.ports and scan.data.ports|length > 0 %}
| Port | Protocol | Service | Product | Version |
|------|----------|---------|---------|---------|
{% for port in scan.data.ports %}| {{ port.port }} | {{ port.protocol or "-" }} | {{ port.service or "-" }} | {{ port.product or "-" }} | {{ port.version or "-" }} |
{% endfor %}
{% else %}
_No open ports found_
{% endif %}

#### Host Information
{% if scan.data.host_addresses or scan.data.hostnames %}
{% if scan.data.host_addresses %}
**Addresses:**
{% for addr in scan.data.host_addresses %}
- {{ addr }}
{% endfor %}
{% endif %}
{% if scan.data.hostnames %}
**Hostnames:**
{% for hostname in scan.data.hostnames %}
- {{ hostname }}
{% endfor %}
{% endif %}
{% else %}
_No host information available_
{% endif %}

#### Operating System Detection
{% if scan.data.operating_systems and scan.data.operating_systems|length > 0 %}
**Operating Systems:**
{% for os in scan.data.operating_systems %}
- {{ os }}
{% endfor %}
{% endif %}
{% if scan.data.os_matches and scan.data.os_matches|length > 0 %}
**OS Matches:**
{% for match in scan.data.os_matches %}
- {{ match }}
{% endfor %}
{% endif %}
{% if scan.data.os_classes and scan.data.os_classes|length > 0 %}
**OS Classes:**
{% for osclass in scan.data.os_classes %}
- {{ osclass }}
{% endfor %}
{% endif %}
{% if not scan.data.operating_systems and not scan.data.os_matches and not scan.data.os_classes %}
_No OS detection information available_
{% endif %}

#### NSE Script Results
{% if scan.data.nse_scripts and scan.data.nse_scripts|length > 0 %}
```
{% for script in scan.data.nse_scripts %}
{{ script }}
{% endfor %}
```
{% else %}
_No NSE script results available_
{% endif %}

#### Traceroute
{% if scan.data.traceroute and scan.data.traceroute|length > 0 %}
{% for hop in scan.data.traceroute %}
- {{ hop }}
{% endfor %}
{% else %}
_No traceroute information available_
{% endif %}

---
{% endfor %}
{% else %}
_No port scan results available. Port scanning was either skipped or not configured._
{% endif %}

---

## Changes since previous run
{% if delta and delta.prev_run is not none %}
Compared to **{{ delta.prev_run }}** → **+{{ delta.counts.new }} new**, **-{{ delta.counts.removed }} removed**.

### New hosts ({{ delta.counts.new }})
{% if delta.new_hosts and delta.new_hosts|length %}
{% for h in delta.new_hosts -%}
- `{{ h }}`
{% endfor %}
{% else %}_(none)_{% endif %}

### Removed hosts ({{ delta.counts.removed }})
{% if delta.removed_hosts and delta.removed_hosts|length %}
{% for h in delta.removed_hosts -%}
- `{{ h }}`
{% endfor %}
{% else %}_(none)_{% endif %}
{% else %}
This is the first recorded run, so there’s nothing to compare yet.
{% endif %}


---

*Generated by ReconSentinel v0. Keep it authorized.*
